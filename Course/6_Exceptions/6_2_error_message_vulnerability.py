import sqlite3


# Vulnerable code
def get_user_info(username):
    conn = sqlite3.connect("example.db")

    cursor = conn.cursor()

    try:
        query = f"SELECT * FROM users WHERE username = '{username}'"
        cursor.execute(query)
        result = cursor.fetchall()
        return result
    except sqlite3.Error as e:
        return str(
            e
        )  # Mitigáció: Általános hibaüzenet visszaadása, ami nem részletezi a hiba konkrét okát


# Test with a malicious input
print(get_user_info("'; DROP TABLE users; --"))
